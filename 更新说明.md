# ä»£ç æ›´æ–°è¯´æ˜

## ğŸ“‹ æ›´æ–°æ¦‚è¿°

æœ¬æ¬¡æ›´æ–°ä¸»è¦å®ç°äº†**4ç§æ¨¡å‹å¯¹æ¯”å®éªŒ**å’Œ**æ¶ˆèå®éªŒå‚æ•°è®°å½•**åŠŸèƒ½ï¼ŒåŒæ—¶æ¸…ç†äº†å†—ä½™æ–‡ä»¶ã€‚

---

## âœ¨ ä¸»è¦æ›´æ–°

### 1ï¸âƒ£ **4ç§æ¨¡å‹å¯¹æ¯”åŠŸèƒ½** (distillation_module.py)

æ–°å¢äº†å®Œæ•´çš„4ç§æ¨¡å‹å¯¹æ¯”å®éªŒï¼Œæ¯ä¸ªæ•°æ®é›†ä¼šæ¯”è¾ƒä»¥ä¸‹æ¨¡å‹ï¼š

| æ¨¡å‹åç§° | è¯´æ˜ | ç‰¹ç‚¹ |
|---------|------|------|
| **Baseline Decision Tree** | åŸå§‹å†³ç­–æ ‘ | ä¸ä½¿ç”¨çŸ¥è¯†è’¸é¦ï¼Œä½œä¸ºåŸºå‡† |
| **Teacher Neural Network** | ç¥ç»ç½‘ç»œæ•™å¸ˆæ¨¡å‹ | æ·±åº¦å­¦ä¹ æ¨¡å‹ï¼Œæ€§èƒ½ä¸Šé™ |
| **FKD** | Full Knowledge Distillation | ä½¿ç”¨å…¨éƒ¨ç‰¹å¾çš„çŸ¥è¯†è’¸é¦ |
| **SHAP-KD** | Top-k Knowledge Distillation | ä½¿ç”¨SHAPé€‰æ‹©çš„Top-kç‰¹å¾è’¸é¦ |

#### æ–°å¢å‡½æ•°ï¼š
- `run_four_model_comparison()` - è¿è¡Œ4ç§æ¨¡å‹å¯¹æ¯”
- `_get_teacher_hard_predictions()` - è·å–æ•™å¸ˆæ¨¡å‹é¢„æµ‹
- `save_four_model_comparison_to_excel()` - ä¿å­˜å¯¹æ¯”ç»“æœåˆ°Excel

#### è¾“å‡ºæ–‡ä»¶ï¼š
```
results/four_model_comparison_YYYYMMDD_HHMMSS.xlsx
```
- åŒ…å«æ¯ä¸ªæ•°æ®é›†çš„ç‹¬ç«‹sheet
- SUMMARY sheetæ±‡æ€»æ‰€æœ‰ç»“æœ
- è®°å½•æ¯ç§æ¨¡å‹çš„: Accuracy, Precision, Recall, F1_Score, Feature_Count, è¶…å‚æ•°

---

### 2ï¸âƒ£ **æ¶ˆèå®éªŒè®°å½•** (ablation_analyzer.py)

ç°æœ‰çš„ `AblationStudyAnalyzer` å·²ç»å®Œæ•´è®°å½•æ¯ç»„å‚æ•°ï¼š

```python
record_experiment_result(
    dataset_name, k, temperature, alpha, max_depth,
    accuracy, f1_score, precision, recall
)
```

#### è¾“å‡ºæ–‡ä»¶ï¼š
- `topk_ablation_study_YYYYMMDD_HHMMSS.csv` - æ¯ç»„å‚æ•°çš„è¯¦ç»†ç»“æœ
- `topk_ablation_study_YYYYMMDD_HHMMSS.json` - JSONæ ¼å¼å¤‡ä»½
- `topk_ablation_visualization_YYYYMMDD_HHMMSS.png` - Top-kå¯è§†åŒ–
- `depth_ablation_visualization_YYYYMMDD_HHMMSS.png` - æ·±åº¦å¯è§†åŒ–

æ¯æ¡è®°å½•åŒ…å«ï¼š
- `dataset`: æ•°æ®é›†åç§°
- `k`: Top-kç‰¹å¾æ•°é‡
- `temperature`: è’¸é¦æ¸©åº¦
- `alpha`: è’¸é¦æƒé‡
- `max_depth`: å†³ç­–æ ‘æ·±åº¦
- `accuracy`: å‡†ç¡®ç‡
- `f1_score`: F1åˆ†æ•°
- `precision`: ç²¾ç¡®ç‡
- `recall`: å¬å›ç‡
- `timestamp`: æ—¶é—´æˆ³

---

### 3ï¸âƒ£ **main.py æ›´æ–°**

#### æ–°æµç¨‹ï¼š
```
Phase 1: Data Preprocessing
Phase 2: Baseline Models Training (6ä¸ªMLæ¨¡å‹)
Phase 3: Teacher Models Training (ç¥ç»ç½‘ç»œ)
Phase 4: SHAP Feature Importance Analysis (4ä¸ªæ•°æ®é›†)
Phase 5: Knowledge Distillation Ablation Study (æ¶ˆèå®éªŒ)
Phase 6: Four-Model Comparison (4ç§æ¨¡å‹å¯¹æ¯”) â† æ–°å¢
Phase 7: Save Time Log
```

#### è¾“å‡ºæ–‡ä»¶æ±‡æ€»ï¼š
1. **åŸºçº¿æ¨¡å‹ç»“æœ**: `baseline_models_comparison_YYYYMMDD_HHMMSS.xlsx`
2. **4ç§æ¨¡å‹å¯¹æ¯”**: `four_model_comparison_YYYYMMDD_HHMMSS.xlsx` â† **æ ¸å¿ƒè¾“å‡º**
3. **SHAPç‰¹å¾å›¾**: `shap_{dataset}_features.png` (4ä¸ªæ•°æ®é›†)
4. **æ¶ˆèå®éªŒæ•°æ®**: `topk_ablation_study_YYYYMMDD_HHMMSS.csv`
5. **è¿è¡Œæ—¶é—´ç»Ÿè®¡**: `time_log_YYYYMMDD_HHMMSS.xlsx`

---

### 4ï¸âƒ£ **æ–‡ä»¶æ¸…ç†**

å·²åˆ é™¤ä»¥ä¸‹æ— ç”¨æ–‡ä»¶ï¼š
- âŒ `test_baseline_excel.py` - æµ‹è¯•æ–‡ä»¶
- âŒ `clean_results.py` - ä¸´æ—¶è„šæœ¬
- âŒ `result_manager.py` - æ—§ç‰ˆç»“æœç®¡ç†å™¨
- âŒ `DEPTH_FIX_REPORT.md` - æ—§æ–‡æ¡£
- âŒ `TASK_COMPLETION.md` - æ—§æ–‡æ¡£
- âŒ `main_simplified.py` - ä¸´æ—¶æ–‡ä»¶
- âŒ `__pycache__/` - Pythonç¼“å­˜

#### å½“å‰é¡¹ç›®ç»“æ„ï¼š
```
ğŸ“ Financial innovation/
â”œâ”€â”€ ğŸ“„ main.py                    # ä¸»ç¨‹åº
â”œâ”€â”€ ğŸ“„ data_preprocessing.py      # æ•°æ®é¢„å¤„ç†
â”œâ”€â”€ ğŸ“„ neural_models.py           # ç¥ç»ç½‘ç»œæ¨¡å‹
â”œâ”€â”€ ğŸ“„ baseline_models.py         # åŸºçº¿MLæ¨¡å‹
â”œâ”€â”€ ğŸ“„ shap_analysis.py           # SHAPåˆ†æ
â”œâ”€â”€ ğŸ“„ distillation_module.py     # çŸ¥è¯†è’¸é¦ (å·²æ›´æ–°)
â”œâ”€â”€ ğŸ“„ ablation_analyzer.py       # æ¶ˆèå®éªŒåˆ†æ
â”œâ”€â”€ ğŸ“„ README.md                  # é¡¹ç›®è¯´æ˜
â”œâ”€â”€ ğŸ“ data/                      # æ•°æ®é›†
â”œâ”€â”€ ğŸ“ results/                   # è¾“å‡ºç»“æœ
â””â”€â”€ ğŸ“ .git/                      # Gitä»“åº“
```

---

## ğŸ”§ å¦‚ä½•ä½¿ç”¨

### è¿è¡Œä¸»ç¨‹åºï¼š
```bash
python main.py
```

### æŸ¥çœ‹4ç§æ¨¡å‹å¯¹æ¯”ç»“æœï¼š
1. æ‰“å¼€ `results/four_model_comparison_*.xlsx`
2. æ¯ä¸ªæ•°æ®é›†æœ‰ç‹¬ç«‹sheetï¼ŒæŸ¥çœ‹4ç§æ¨¡å‹çš„æ€§èƒ½å¯¹æ¯”
3. SUMMARY sheetæ±‡æ€»æ‰€æœ‰æ•°æ®é›†çš„ç»“æœ

### æŸ¥çœ‹æ¶ˆèå®éªŒè¯¦ç»†æ•°æ®ï¼š
1. æ‰“å¼€ `results/topk_ablation_study_*.csv`
2. æ¯è¡Œè®°å½•ä¸€ç»„å‚æ•°(k, temperature, alpha, max_depth)çš„ç»“æœ
3. å¯ç”¨äºåˆ†ææœ€ä¼˜å‚æ•°ç»„åˆ

---

## ğŸ“Š é¢„æœŸè¾“å‡ºç¤ºä¾‹

### four_model_comparison.xlsx ç¤ºä¾‹ï¼š

#### GERMAN sheet:
| Model | Accuracy | Precision | Recall | F1_Score | Feature_Count | k | Temperature | Alpha | Max_Depth |
|-------|----------|-----------|--------|----------|---------------|---|-------------|-------|-----------|
| Baseline Decision Tree | 0.7200 | 0.7150 | 0.7200 | 0.7175 | 54 | - | - | - | 5 |
| Teacher Neural Network | 0.7650 | 0.7600 | 0.7650 | 0.7625 | 54 | - | - | - | - |
| FKD (All Features) | 0.7450 | 0.7400 | 0.7450 | 0.7425 | 54 | - | 3.0 | 0.5 | 5 |
| SHAP-KD (Top-10) | 0.7350 | 0.7300 | 0.7350 | 0.7325 | 10 | 10 | 3.0 | 0.5 | 5 |

---

## âœ… éªŒè¯æ¸…å•

- [x] 4ç§æ¨¡å‹å¯¹æ¯”åŠŸèƒ½å·²å®ç°
- [x] æ¯ä¸ªæ•°æ®é›†éƒ½è¿è¡Œ4ç§æ¨¡å‹
- [x] ç»“æœä¿å­˜åˆ°Excelï¼ˆå¤šsheetæ ¼å¼ï¼‰
- [x] æ¶ˆèå®éªŒè®°å½•æ¯ç»„å‚æ•°çš„4é¡¹æŒ‡æ ‡
- [x] æ¶ˆèæ•°æ®ä¿å­˜åˆ°CSVå’ŒJSON
- [x] åˆ é™¤æ‰€æœ‰æ— ç”¨æ–‡ä»¶å’Œ__pycache__
- [x] main.pyæµç¨‹æ›´æ–°
- [x] ä»£ç æ³¨é‡Šå®Œæ•´

---

## ğŸ¯ æ€»ç»“

æœ¬æ¬¡æ›´æ–°å®ç°äº†å®Œæ•´çš„**4ç§æ¨¡å‹å¯¹æ¯”æ¡†æ¶**ï¼Œå¯ä»¥ç³»ç»Ÿæ€§åœ°æ¯”è¾ƒï¼š
1. åŸå§‹å†³ç­–æ ‘åŸºçº¿
2. æ·±åº¦å­¦ä¹ æ•™å¸ˆæ¨¡å‹ä¸Šé™
3. å…¨ç‰¹å¾çŸ¥è¯†è’¸é¦æ•ˆæœ
4. Top-kç‰¹å¾è’¸é¦æ•ˆæœ

åŒæ—¶ï¼Œæ¶ˆèå®éªŒè¯¦ç»†è®°å½•äº†æ¯ç»„è¶…å‚æ•°(k, temperature, alpha, max_depth)ä¸‹çš„æ€§èƒ½æŒ‡æ ‡ï¼Œä¸ºåç»­è®ºæ–‡åˆ†ææä¾›å®Œæ•´æ•°æ®æ”¯æŒã€‚

---

**æ›´æ–°æ—¥æœŸ**: 2025å¹´11æœˆ25æ—¥  
**ç‰ˆæœ¬**: v2.0
